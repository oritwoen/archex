# Maintainer: talone <talone@boxph.one>
# co-Maintainer: Igor Dyatlov <dyatlov.igor@protonmail.com>

pkgname=authenticator
pkgver=4.2.0+1507+01224b3
pkgrel=2
pkgdesc="2FA code generator for GNOME"
arch=('any')
url="https://gitlab.gnome.org/world/authenticator"
license=("GPL3")
depends=('libsecret' 'zbar' 'libadwaita' 'gstreamer' 'gst-plugins-base' 'gst-plugins-bad' 'pipewire')
makedepends=('meson' 'gobject-introspection' 'cargo' 'clang')
source=(git+https://gitlab.gnome.org/world/authenticator.git)
b2sums=('SKIP')

pkgver() {
    cd ${pkgname}

    local _version=$(grep -m 1 "version:" meson.build | cut -d "'" -f2)

    echo ${_version}+$(git rev-list --count HEAD)+$(git rev-parse --short HEAD)
}

build() {
  arch-meson $pkgname build

  meson compile -C build
}


package() {
  meson install -C build --destdir "$pkgdir"
}
